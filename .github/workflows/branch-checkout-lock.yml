name: Maintenance - Export Lock File Contents

# This workflow is ONLY triggered manually by the user
on:
  workflow_dispatch:
    inputs:
      branch:
        description: 'Branch to run on (e.g., feat/my-branch). Defaults to main.)'
        required: false
        default: 'main'

jobs:
  export-lock-file:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          # Check out the correct branch to generate files for that state
          ref: ${{ github.event.inputs.branch || 'main' }}

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Generate Lock File (npm install)
        # This resolves dependencies and creates package-lock.json in the runner
        run: |
          rm -f package-lock.json
          npm install
          echo "Lock file generated successfully in the runner."

      - name: Export Lock File Content
        # This step reads the file and prints its contents to the log.
        run: |
          echo "=========================================================================="
          echo "COPY THE CONTENTS BELOW (from the line that starts with '{' to the line that ends with '}')"
          echo "=========================================================================="
          cat package-lock.json
          echo "=========================================================================="
          echo "End of package-lock.json content."